## 情况说明
HO模式下，HLD任务，会拆分为多个LLD任务，其中，CO一个LLD任务（类型CO），每根trunk一个LLD任务（类型Feeder），然后每个Cluster一个LLD任务（类型Distribution）。

HO模式下， Feeder和Distribution的资源需要经过OTDR单，才可以发起同步入网。而CO的资源，由于不走施工，则随时可以进行入网。

HO模式下，CO会被Feeder和Distribution进行引用，用于进行主干光缆的施工。

但这种情况下，CO内的ODF和主干光缆的连接，则无法进行入网。

## 修改后的逻辑

1. CO需要反向引用主干的光缆（从而也引用了光缆的另一端的1FCP），从而在CO内对于主干的连接进行处理。

	这里的改动点主要是：
	*  需要支持方案间的循环引用
	* 引用目前的逻辑会产生一个新的GIS对象，则这种情况下，如果循环引用后，需要保证在当前任务单内的光缆的A/Z GIS_KEY为当前任务单内资源（SITE）的GIS_KEY。
	* 这部分动作改为在HLD解析的时候就直接处理，不需要人工处理

2. 在CO内增加OLT、ODF，然后ODF和主干光缆进行绑定，并进行连接（目前已支持）
3. 入网的逻辑处理：
	* 总体入网逻辑主要就是判断当前可入网的资源的范围：
		* CO任务单，可入网资源即当前任务单内，所有未同步的资源和连接
		* OTDR任务单，即当前OTDR任务单所对应的SPLICE_POINT的关联的所有资源，这里关联的含义包括：
			* 连接：关联的设备（分光器），缆线，缆线的另一端设备，以及连接产生的设备
			* 设备：关联的设施（HO没有这种情况）
			* 缆线：关联的设施段（HO没有这种情况）
			* 分光器：关联的设备
	* 然后在可入网的资源中判断当前任务是否可以入网
		* 连接：需要保证关联的设备（分光器），缆线，以及连接产生的设备都已经入网或者在当次入网任务中已经包含
		* 设备：关联的设施已经入网或者在当次入网任务中已经包含（HO没有这种情况）
		* 缆线：关联的设施段已经入网或者在当次入网任务中已经包含（HO没有这种情况）
			       两端已经绑定设备，并且两端设备已经入网，或者在当次入网任务中已经包含
		*  分光器：关联的设备已经入网或者在当次入网任务中已经包含

	* 如果存在不可入网的资源：
		* CO方案由于可以重复发起同步，则忽略这部分不可入网资源
		* Feeder和Distribution方案则需要提示Publish单失败以及错误信息，并允许重新发起

		另外，由于覆盖设备入网后，我们需要保证地址也自动发起入网，则覆盖设备的入网额外需要考虑地址入网的要求。

4. 地址入网

	地址入网需要的前提：
		1. 当前OTDR单的发起设备是一个覆盖设备，存在覆盖地址。
		2. 当前OTDR单的连接中已经具备一个可以连接到OLT的链路，并且链路中的关联资源都已经入网或者在当前OTDR单的入网资源中。

	由于地址入网单是对应OTDR单的PUBLISH单一起处理的，则如果报错的情况下，整个PUBLISH单需要回退，同时支持重新发起。

	